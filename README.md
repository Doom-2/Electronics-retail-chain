# API для онлайн платформы торговой сети электроники

## Бизнес-задача

1. Спроектировать модель торговой сети электроники со следующей структурой:
    * Название;
    * Контакты:
        * Email;
        * Страна;
        * Город;
        * Улица;
        * Номер дома;
    * Продукты:
        * Название;
        * Модель;
        * Дата выхода продукта на рынок;
    * Поставщик (предыдущий по иерархии объект сети);
    * Задолженность перед поставщиком в денежном выражении с точностью до копеек;
    * Время создания (заполняется автоматически при создании).

2. Сеть должна представлять собой иерархическую структуру из 3 уровней:
    * Завод;
    * Розничная сеть;
    * Индивидуальный предприниматель.

3. Сделать вывод в админ-панели созданных объектов. \
   На странице объекта сети добавить:
    * ссылку на «Поставщика»;
    * фильтр по названию города;
    * «admin action», очищающий задолженность перед поставщиком у выбранных объектов.

4. Используя DRF, сделать CRUD на модель звена сети со следующим функционалом:
    * запретить обновление через API поля «Задолженность перед поставщиком»
    * добавить фильтрацию по стране.
5. Настроить доступ к API только для аутентифицированных пользователей.

## Варианты реализации

1. [Ветка master](https://github.com/Doom-2/Electronics-retail-chain/tree/master)\
   Максимальное соответствие ТЗ.\
   Различия c ТЗ:
    * добавлено поле `legal_name` (юридическое имя, текущий по иерархии объект сети) как `fk` на модель `BusinessUnit`
    * в админ панели 2 ссылки: на владельца звена, поле `legal_name` и на его поставщика как `fk` на другое поле той же
      модели `BusinessUnit`.

&nbsp;
   <p align="center">
    <img src="/images/Link%20master.png" alt="Link master"/>
    </p>

2. [Ветка models_variant_2](https://github.com/Doom-2/Electronics-retail-chain/tree/models_variant_2)
    Модель сети с бо́льшим соответствием реальной бизнес модели.\
    Различия с ТЗ:
     * добавлено поле `legal_name` (юридическое имя) как `fk` на модель `LegalPerson`
     * в админ панели 2 ссылки: на владельца звена `legal_name` и на его поставщика, поле `supplier`
        из модели LegalPerson, которое в свою очередь имеет отношение `ManyToMany` к модели `BusinessUnit`
     * в модель `Product` добавлено поле `type` как `fk` на таблицу `ProductType`.

&nbsp;
   <p align="center">
    <img src="/images/Link%20models_var_2.png" alt="Link models_var_2"/>
    </p>

## Запуск проекта

1. Склонировать репозиторий на локальный компьютер.
2. Установить сервисы Docker и Docker Compose.
3. Переименовать файл `.env.example` в `.env` и заполнить его по шаблону внутри файла
4. Запустить контейнер с Postgres командой `docker compose up -d`
5. Создать и накатить миграции в базе данных командами `./manage.py makemigrations` и `./manage.py migrate`
6. Запустить веб-сервер для разработки командой `./manage.py runserver`
7. Backend будет доступен по адресу `http://127.0.0.1:8000/`

## Доступные маршруты

### Модель Link:

* `link/` - CRUD для звеньев (объектов) торговой сети

### Модель User:

* `user/signup/` - создание пользователя
* `user/login/` - аутентификация пользователя
* `user/profile/` - карточка пользователя
* `user/logout/` - выход из системы

###### Примечание: CRUD для пользователя сделан для удобства его создания через форму DRF.
